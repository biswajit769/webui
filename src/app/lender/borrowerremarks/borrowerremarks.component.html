<div>
    <div class="lenderdashboard">
        <div class="row">
            <h1 style="margin-top:10%;"><img alt="loan" src="assets/images/Loan Request.png" align="center" style="width: 5%;">&nbsp; Active Loans</h1>
        </div>
    </div>
    <!-- <div>
        <span id="itemsperpagemargin" style="margin-top: 0px;
            margin-bottom: 10px;"></span>
        <input ng-model="search" type="text" class="adminsearchbox" placeholder="Enter Borrower Name" name="search">
    </div> -->
    <div class="col-md-6 form-group">
        <input type="text" class="form-control" [(ngModel)]="userFilter" placeholder="Search">
    </div>
    <div class="table-responsive col-md-12">
        <div class="table-responsive flexcroll" id="loanTableStyle" style="height: 100%;">
            <table class="table table-striped table-bordered text-center">
                <thead class="tableheader">
                    <tr>
                        <th style="text-align: center">Serial No</th>
                        <th style="text-align: center">Loan Id</th>
                        <th style="text-align: center">Company Name</th>
                        <th style="text-align: center">Requested Date</th>
                        <th style="text-align: center">Loan Amount</th>
                        <th style="text-align: center">Loan Status</th>
                    </tr>
                </thead>
                <tbody *ngIf="viewhistory.length>0">
                     
                    <tr  class="cursor" *ngFor="let view of viewhistory | filter: userFilter;let i = index">
                        <td>{{i+1}}</td>
                        <td>{{view.id}}</td>
                        <td>{{view.borrower_Name}}</td>
                        <!-- <td (click)="loan_details(view)">{{view.requested_date | date:'dd-MM-yy'}}</td> -->
                         <td> {{view.requested_date  | date: 'dd'}}/{{view.requested_date  | date:'MM'}}/{{view.requested_date | date : 'yyyy'}}</td>
                        <td>{{view.loan_amount}}</td>
                        <td>
                            <button *ngIf="view.status =='Accepted'" class="btn btn-primary" (click)="disburse(view.id)">Disburse</button>
                            <button  *ngIf="view.status !='Accepted'" class="btn btn-primary" style="color: #ffffff;" (click)="viewwwinfo(view.id)">View</button>
                          <!--   <button  *ngIf="view.status =='Bided' && (view.status !='Accepted'||view.status !='Disbursed')" class="btn btn-primary" style="color: #ffffff;" (click)="upfrontView(view.id)">Bided</button> -->
                        </td>
                     
                    </tr>
                  
                </tbody>
                <tbody>
                <tr *ngIf="viewhistory.length==0">
                        <td colspan="6" class="text-center orangefont">No Active Loans</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>


<!-- Modal -->

<!-- <div id="myModal" #disburseviewPopup class="modal fade">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" (click)="cancel1();" aria-hidden="true">&times;</button>
                    <h4 class="modal-title" id="myModalLabel">
                            Thank you for disbursing the loan...!!!
                        </h4>
                        <p>Please acknowledge the same with the Transaction ID</p>
                </div>
                <div class="modal-body">
                        <label for="inputEmail3">Borrower Disbursement Transaction ID </label>
                        <input type="text" class="form-control" [(ngModel)]="borrower_disbursement"
                        id="inputEmail3" placeholder="Please Enter the Transaction ID"/>
                        <label  for="inputPassword3" >FINCHAIN Disbursement Transaction ID</label>
                  
                      <input type="text" class="form-control" [(ngModel)]="finchain_disbursement"
                          id="inputPassword3" placeholder="Please Enter the Transaction ID"/>
                  
                </div>
               
                        <div class="modal-footer">
                                <button type="submit" class="btn btn-primary" [disabled]="!(borrower_disbursement && finchain_disbursement)" (click)="disbursement_details(borrower_disbursement,finchain_disbursement)">
                           
                                ok
                            </button>
                    <button type="button" class="btn btn-default" (click)="cancel1();" >Close</button>
                   
                </div>
            
        </div>
    </div>
    </div> -->
   <!-- active view closed loan -->
<!--    <div  #closedloan class="modal fade">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title" id="myModalLabel">
                             Loan closed...!!!
                        </h4>
                        
                </div>
                <div class="modal-body">
                        <p> Are you sure to close the loan?</p>
                </div>
    <div class="modal-footer">
        <button type="submit" class="btn btn-primary" (click)="closeloanstatus()">
        close loan
        </button>
        <button type="button" class="btn btn-default" data-dismiss="modal" >Cancel</button>
    </div>
            
        </div>
    </div>
   </div> -->
 <!--    <div class="modal fade" *ngIf="show1" #loandetailsView>
            <div class="modal-dialog modal-confirm">
                <div class="modal-content">
                    <div class="modal-header loanModalHeader">
                                    
                        <button type="button" class="btn btn-default crossymbol" data-dismiss="modal">&times;</button>
                <h3 class="modal-title" *ngIf="disbursement">Loan ID&nbsp;&nbsp;&nbsp;{{loandetails[0].loan}}</h3>
                    </div>
                    <div class="modal-body">
        
                        <div *ngIf="disbursement" >
                            
                            <table class="table table-striped table-condensed table-responsive" id="tblGrid">
                                            <tbody>
                                                    <div class="col-md-12" style="    padding: 0px 35px 10px;">
                                <div class="col-md-6">

                                      <tr>
                                        <th>Company Name</th> 
                                        <td>&nbsp;&nbsp;&nbsp;{{loandetails[0].borrower_name}}</td>
                                      
                                      </tr>
                                      <tr>
                                            <th>Loan Amount</th>
                                            
                                            <td>&nbsp;&nbsp;&nbsp;{{loandetails[0].loan_amount}}</td>
                                        </tr>
                                        <tr>
                                                <th>Balance Amount</th>
                                                 {{companydetails.joined_date | date : "dd/MM/y"}} -->
                                               <!--  <td>&nbsp;&nbsp;&nbsp;{{loan_data.balance}}</td>
                                            </tr>
                                            <tr>
                                                    <th>Disbursed Amount</th>
                                                    <td>&nbsp;&nbsp;&nbsp;{{loandetails[0].disbursed_amount}}</td>
                                                </tr>
                                                <tr>
                                                    <th>Interest Amount</th>
                                                    <td>&nbsp;&nbsp;&nbsp;{{loan_data.interest_amount}}</td>
                                                </tr>
                                            </div>
                                            <div class="col-md-6">
                                                <tr>
                                                    <th>Payment Type</th>
                                                    <td>&nbsp;&nbsp;&nbsp;{{  loandetails[0].repayment_type }}</td>
                                                </tr>
                                                <tr>
                                                    <th>Disbursed Date</th>
                                                    <td>&nbsp;&nbsp;&nbsp;{{loandetails[0].disbursed_date | date : "dd/MM/y"}}</td>
                                                </tr>
                                                <tr>
                                                        <th>Paid Amount</th
                                                                                                                <td>&nbsp;&nbsp;&nbsp;{{paid_amt || 0}}</td>
                                                    </tr>
                                                  
                                                    <tr>
                                                        <th>Closing Date</th>
                                                       
                                                        <td> &nbsp;&nbsp;&nbsp;{{lastdate | date : "dd/MM/y" || 0}} </td>
                                                    </tr> 
                                                </div>
                                                
                                </div>
                                

                                    
                                    </tbody>
                                    <div class="abc">
                                        <button type="button"  class="btn btn-primary" (click)="Enteramount(loandetails[0]);">Enter Amount</button>
                                      </div>
                                    
                                  </table>
                                  
                                   
                              <table class="table table-striped table-bordered text-center" >
                                            <thead class="tableheader">
                                                <tr>
                                                    <th style="text-align: center">Serial No</th>
                                                    <th style="text-align: center">Payable</th>
                                                    <th style="text-align: center">Penaulty Amount</th>
                                                    <th style="text-align: center">Payable Amount</th>
                                                    <th style="text-align: center">Payable date</th>
                                                    <th style="text-align: center">Payment Status</th>
                                                    <th style="text-align: center">Updated Date</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                 
                                                <tr  class="cursor" *ngFor="let  detail of loandetails ;let i = index">
                                                    <td>{{i+1}}</td>
                                                    <td>{{detail.payable}}</td>
                                                    <td>{{detail.penalty_amount}}</td>
                                                    <td>{{detail.payable_amount}}</td>
                                                    <td>{{detail.payable_date}}</td>
                                                    <td>
                                                        <button class="btn btn-warning">{{detail.payment_status}}</button>
                                                    </td>
                                                    <td>{{detail.updated_date}}</td>
                                                 
                                                </tr>
                                              
                                            </tbody>
                                           
                                        </table>
                                   
                                </div>
                         
                    </div>
                   
                </div>
                
            </div>
        </div>  --> 

    <!--     <div class="modal fade" *ngIf="show2" #bankdetailsView>
                <div class="modal-dialog modal-confirm">
                    <div class="modal-content">
                        <div class="modal-header loanModalHeader">
                                        
                            <button type="button" class="btn btn-default crossymbol" data-dismiss="modal">&times;</button>
                    <h3 class="modal-title">Loan ID&nbsp;&nbsp;&nbsp;{{loan.id}}</h3>
                        </div>
                        <div class="modal-body">
        <div>
                <table class="table table-striped table-condensed table-responsive" id="tblGrid">
                        <thead id="tblHead">
                                <tr>
                                        <td colspan="2" style="text-align: center;font-size: 18px;color: white;padding: inherit;background:  #337ab7;">Loan Details</td>
                                    </tr>
                                </thead> 
                                <tbody>
                          <tr>
                            <th>Loan Amount</th>
                            <td>{{loan.loan_amount}}</td>
                          
                          </tr>
                          <tr>
                            <th>Interest Amount</th>
                            <td>{{loan.interest_amount}}</td>
                            </tr>
                            <tr>
                                <th>Processing Fee</th>
                                <td>{{loan.processing_fee}}</td>
                                </tr>
                                <tr>
                                    <th>Membership Fee</th>
                                    <td>{{loan.membership_fee}}</td>
                                    </tr>
                                    <tr>
                                            <th>Insurance</th>
                                            <td>{{loan.insurance}}</td>
                                    </tr>
                                    <tr>
                                            <th>Disbursement Amount (to Finchian)</th>
                                            <td>{{loan.rtm_disbursement}}</td>
                                    </tr>
                                   
                         <th colspan="2" style="text-align: center;font-size: 18px;color: white;padding: inherit;background:  #337ab7;">Borrowing Company Bank Details</th>           
                             <tr>
                                <th>Name</th>
                                <td>{{holder_name}}</td>
                            </tr>
                            <tr>
                                <th>Bank Name</th>
                                <td>{{selected_bank}}</td>
                            </tr>
                            <tr>
                                <th>Branch Name </th>
                                <td>{{branch_name}}</td>
                            </tr>
                            <tr>
                                <th>Account Number</th>
                                <td>{{account_number}}</td>
                            </tr>
                            <tr>
                                <th>IFSC Code</th>
                                <td>{{ifsc_code}}</td>
                            </tr>
                            <th colspan="2" style="text-align: center;font-size: 18px;color: white;padding: inherit;background:  #337ab7;">FINCHAIN Bank Details</th>
                            <tr>
                                <th>Name</th>
                                <td>FINCHAIN Technologies Private Limited
                            </tr>
                            <tr>
                                <th>Bank Name</th>
                                <td>State Bank of India</td>
                            </tr>
                            <tr>
                                <th>Branch Name </th>
                                <td>Sahakarnagar, Bangalore</td>
                            </tr>
                            <tr>
                                <th>Account Number</th>
                                <td>36511888680</td>
                            </tr>
                            <tr>
                                <th>IFSC Code</th>
                                <td>SBIN0005191</td>
                            </tr>
                        </tbody>
                      </table>
                    </div>
                    </div>
                    </div>
                    </div>
                    </div>
                    Enter Amount POPUp -->
                    <!-- <div id="myModal" #EneterAmountpopup class="modal fade">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                   <button type="button" class="close" (click)="cancel1();" aria-hidden="true">&times;</button>
                                    <h4 class="modal-title" id="myModalLabel">
                                            Please Enter The Amount...!!!
                                        </h4>
                                        
                                </div>
                                <div class="modal-body">
                                        <label for="inputEmail3">Enter Amount</label>
                                        <input type="text" class="form-control" [(ngModel)]="AmountName"
                                        id="inputEmail3" (keypress)="keyPress($event)" placeholder="Please Enter the Amount"/>
                                          <label for="inputEmail3">Payment Mode </label>
                                          <select [(ngModel)]="PaymentMode" class="form-control" id="inputEmail3">
                                            <option value="" [disabled]="true">
                                               Please Select Payment Mode
                                                </option>
                                            <option *ngFor="let group of paymentModemethods">
                                            {{group}}
                                            </option>
                                        </select>
                                        <label  for="inputPassword3" >Enter Remarks</label>
                                  
                                        <input type="text" class="form-control" [(ngModel)]="enter_Remarks"
                                            id="inputPassword3" placeholder="Please Enter the Remarks"/>
                                </div>
                                        <div class="modal-footer">
                                                <button type="submit" class="btn btn-primary" [disabled]="!(AmountName && enter_Remarks && PaymentMode)" (click)="SendPayment(AmountName,PaymentMode,enter_Remarks)">
                                           
                                                ok
                                            </button>
                                    <button type="button" class="btn btn-default" (click)="cancel1();" >Close</button>
                                   
                                </div>
                            
                        </div>
                    </div>
                    </div> --> 
                    <!-- Rate of interest popup modal -->
<!-- <div class="modal fade" #acceptpopup>
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header loanModalHeader">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
                <div class="col-xs-11 col-sm-11 col-md-11">
                    <h3 class="modal-title">How would you like to get the Interest Amount</h3>
                </div>
                <div class="col-xs-1 col-sm-1 col-md-1" style="padding: 5px;">
                    <button class="btn btn-primary" data-toggle="modal" data-target="#popuplender">Help</button>
                </div>
            </div>
            <div class="modal-body">
                <div class="modal-body">

                    <input type="radio" name="deduction_type" [(ngModel)]="deduction" value="upfront">Up Front
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    <input type="radio" name="deduction_type" [(ngModel)]="deduction" value="later">Later
                    <div class="modal-footer">
                        <button class="btn btn-primary" [disabled]="!deduction" (click)="loanaccepted(deduction)">OK</button>
                        <button class="btn btn-warning" type="button" click="cancel()">Cancel</button>
                    </div>
                </div>

            </div>


        </div>
    </div>
</div> -->


 <div id="myModal" #companyremarksview class="modal fade " role="dialog">
    <div class="modal-dialog" >
<div class="modal-content">
  <div class="modal-header">
  <button type="button" class="btn btn-default crossymbol" data-dismiss="modal"ng-click="cancel()">&times;</button>
                <h3 class="modal-title" ng-show="disbursement">Company Remarks Details</h3>
                <!-- <h3 class="modal-title" ng-hide="disbursement">Loan Disbursement Details</h3> -->
            </div>
            <div class="modal-body">
                <div ng-show="disbursement">
                    <!-- <table class="table-responsive">
                        <table class="col-md-6">
                            <tr>
                                <th style="width:50%;">Borrower Name</th>
                                <td>{{loandetails[0].borrower_name}}</td>
                            </tr>
                            <tr>
                                <th>Loan Amount</th>
                                <td>{{loandetails[0].loan_amount}}</td>
                            </tr>
                            <tr>
                                <th>Tenure</th>
                                <td>{{loandetails[0].tenure}}</td>
                            </tr>
                            <tr>
                                <th>Disbursed Amount</th>
                                <td>{{loandetails[0].disbursed_amount}}</td>
                            </tr>
                        </table>
                        <table class="col-md-6">
                            <tr>
                                <th style="width:50%;">Rate of Interest</th>
                                <td>{{loandetails[0].interest}}</td>
                            </tr>
                            <tr>
                                <th>Interest Amount</th>
                                <td>{{loandetails[0].loan_amount * loandetails[0].interest / 100 * loandetails[0].tenure}}</td>
                            </tr>
                            <tr>
                                <th>Disbursed Date</th>
                                <td>{{loandetails[0].disbursed_date}}</td>
                            </tr>
                            <tr>
                                <th>Repayment Type</th>
                                <td>{{loandetails[0].repayment_type}}</td>
                            </tr>
                        </table>
                        <table class="table table-striped table bordered space1">
                            <tr>
                                <th style="font-size: 18px;color: white;padding: inherit;background: #ed6506;">Payable Amount</th>
                                <th style="font-size: 18px;color: white;padding: inherit;background: #ed6506;">Payable date</th>
                                <th style="font-size: 18px;color: white;padding: inherit;background: #ed6506;">Payment Status</th>
                            </tr>
                            <tr ng-repeat="detail in loandetails">
                                <td>{{detail.payable_amount}}</td>
                                <td>{{detail.payable_date}}</td>
                                <td>{{detail.payment_status}}</td>
                            </tr>
                        </table>
                    </table> -->
               <!--  </div>
                <div ng-hide="disbursement">
                    <table class="table-responsive">
                        <table class="table table-striped table bordered">
                            <tr>
                                <th colspan="2" style="text-align: center;font-size: 18px;color: white;padding: inherit;background: #337ab6;">Loan Details</th>
                            </tr>
                            <tr>
                                <th>Loan ID</th>
                                <td>{{poplendloan3|| 'empty'}}</td>
                            </tr>
                            <tr>
                                <th>Loan Amount</th>
                                <td>{{poplendloan4|| 'empty'}}</td>
                            </tr>
                            <tr>
                                <th>Interest Amount</th>
                                <td>{{poplendloan5|| 'empty'}}</td>
                            </tr>
                            <tr>
                                <th>Processing Fee</th>
                                <td>{{'empty'}}</td>
                            </tr>
                            <tr>
                                <th>Membership Fee</th>
                                <td>{{'empty'}}</td>
                            </tr>
                            <tr>
                                <th>Insurance</th>
                                <td>{{'empty'}}</td>
                            </tr>
                            <tr>
                                <th>Disbursement Amount (to Company)</th>
                                <td>{{poplendloan6|| 'empty'}}</td>
                            </tr> -->
                            <!-- <tr>
                                <th>Disbursement Amount (to RTM)</th>
                                <td>{{poplendloanhistroy1.rtm_disbursement}}</td>
                            </tr> -->
                        <!--     <th colspan="2" style="text-align: center;font-size: 18px;color: white;padding: inherit;background: #337ab6;">Company Bank Details</th>
                            <tr>
                                <th>Loan ID</th>
                                <td>{{companyremarks[0].loan_id}}</td>
                            </tr>
                             <tr>
                                <th>Paid Amount</th>
                                <td>{{companyremarks[0].paid_amount}}</td>
                            </tr> -->
                   <!--         <tr>
                                <th>Branch Name </th>
                                <td>{{poplendloanhistroy.branch_name}}</td>
                            </tr>
                            <tr>
                                <th>Account Number</th>
                                <td>{{poplendloanhistroy.account_number}}</td>
                            </tr>
                            <tr>
                                <th>IFSC Code</th>
                                <td>{{poplendloanhistroy.ifsc_code}}</td>
                            </tr> -->
                           
                          
                     <!--    </table> -->


                              <table class="table table-striped table-bordered text-center" >
                                            <thead class="tableheader">
                                                <tr>
                                                    <th style="text-align: center">Serial No</th>
                                                    <th style="text-align: center">Loan ID</th>
                                                    <th style="text-align: center">Paid Amount</th>
                                                    <th style="text-align: center">Payment Via</th>
                                                    <th style="text-align: center">Remarks</th>
                                                   <!--  <th style="text-align: center">Payment Status</th>
                                                    <th style="text-align: center">Updated Date</th> -->
                                                </tr>
                                            </thead>
                                            <tbody>
                                                 
                                                <tr  class="cursor" *ngFor="let  remarks of companyremarks ;let i = index">
                                                
                                                    <td>{{i+1}}</td>
                                                    <td>{{remarks.loan_id}}</td>
                                                    <td>{{remarks.todays_amount}}</td>
                                                    <td>{{remarks.paymode}}</td>
                                                    <td>{{remarks.status}}</td>
                                               <!--      <td>
                                                        <button class="btn btn-warning bccolor">{{detail.payment_status}}</button>
                                                    </td>
                                                    <td>{{detail.updated_date}}</td> -->
                                                 
                                                </tr>
                                              
                                            </tbody>
                                           
                                        </table>
                    <!-- </table> -->
                </div>
                <div class="modal-footer">
                    <button class="btn btn-primary" type="button" ng-click="cancel()" data-dismiss="modal">OK</button>
                </div>
            </div>
     
       </div>
       </div>
      </div>
   




